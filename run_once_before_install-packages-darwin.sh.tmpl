{{- if (env "DO_NOT_RUN_INSTALL_SCRIPT" | ne "true") }}
{{- if (eq .chezmoi.os "darwin") -}}
#!/bin/bash
which -s brew
if [[ $? != 0 ]] ; then
    # Install Homebrew
    /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
else
    brew update
fi
/opt/homebrew/bin/brew bundle --no-lock --file=/dev/stdin <<EOF
tap "caraar12345/tap"
tap "hashicorp/tap"
tap "homebrew/bundle"
tap "homebrew/services"
tap "jorgelbg/tap"
tap "teamookla/speedtest"
brew "act"
brew "glib"
brew "pkg-config"
brew "adwaita-icon-theme"
brew "python@3.11"
brew "afflib"
brew "numpy", link: false
brew "tcl-tk"
brew "pillow", link: false
brew "binwalk"
brew "black"
brew "caddy"
brew "certbot"
brew "chezmoi"
brew "cloudflared"
brew "cmake"
brew "ruby"
brew "coreutils"
brew "curl"
brew "direnv"
brew "fd"
brew "libtool"
brew "unbound"
brew "gnutls"
brew "lame"
brew "libarchive"
brew "libass"
brew "libvorbis"
brew "opus"
brew "libvpx"
brew "srt"
brew "theora"
brew "x264"
brew "x265"
brew "xvid"
brew "ffmpeg"
brew "flarectl"
brew "fnm"
brew "gh"
brew "git"
brew "git-lfs"
brew "gsettings-desktop-schemas"
brew "glib-networking"
brew "glow"
brew "go"
brew "gobject-introspection"
brew "gobuster"
brew "goenv"
brew "grep"
brew "libnice"
brew "libgcrypt"
brew "gtksourceview4"
brew "htop"
brew "httpie"
brew "shared-mime-info"
brew "libheif"
brew "imagemagick"
brew "influxdb-cli"
brew "iperf3"
brew "iproute2mac"
brew "pygments"
brew "ipython", link: false
brew "isort"
brew "jq"
brew "pandoc"
brew "jupyterlab", link: false
brew "ldns"
brew "libewf"
brew "libfido2"
brew "openssl@3"
brew "libp11"
brew "libpq"
brew "libvirt"
brew "libxml2"
brew "lsusb"
brew "luajit"
brew "macchina"
brew "make"
brew "markdown"
brew "meson"
brew "moreutils", link: false
brew "name-that-hash"
brew "nasm"
brew "ncdu"
brew "neovim"
brew "nmap"
brew "opensc"
brew "openssh"
brew "parallel"
brew "pinentry-mac"
brew "pipenv"
brew "pkcs11-helper"
brew "pkcs11-tools"
brew "pre-commit"
brew "prettyping"
brew "py3cairo"
brew "pyenv"
brew "pyenv-virtualenv"
brew "pygobject3"
brew "pylint"
brew "qrencode"
brew "rbenv"
brew "rclone"
brew "rhash"
brew "ripgrep"
brew "rustup-init"
brew "sdl12-compat"
brew "semgrep"
brew "sevenzip"
brew "sha3sum"
brew "shtool"
brew "socat"
brew "sox"
brew "step"
brew "subversion"
brew "swig"
brew "task"
brew "telnet"
brew "testdisk"
brew "texi2html"
brew "tfenv"
brew "the_silver_searcher"
brew "tidy-html5"
brew "vala"
brew "vault"
brew "vte3"
brew "watch"
brew "websocat"
brew "wget"
brew "woff2"
brew "yarn"
brew "yq"
brew "yt-dlp"
brew "zsh"
brew "teamookla/speedtest/speedtest"
cask "1password"
cask "1password-cli"
cask "discord"
cask "font-fantasque-sans-mono-nerd-font"
cask "font-ibm-plex-mono"
cask "font-ibm-plex-sans"
cask "font-ibm-plex-serif"
cask "font-iosevka"
cask "font-iosevka-nerd-font"
cask "font-open-sans"
cask "google-chrome"
cask "google-drive"
cask "google-cloud-sdk"
cask "iina"
cask "iterm2"
cask "little-snitch"
cask "macfuse"
cask "mattermost"
cask "microsoft-office"
cask "microsoft-remote-desktop"
cask "notion"
cask "orbstack"
cask "reflector"
cask "rocket"
cask "secretive"
cask "setapp"
cask "signal"
cask "spotify"
cask "steam"
cask "syntax-highlight"
cask "teamviewer"
cask "telegram"
cask "transmission"
cask "unified-remote"
cask "visual-studio-code"
cask "vlc"
EOF

defaults write com.googlecode.iterm2.plist PrefsCustomFolder -string "$HOME/.iterm2"
defaults write com.googlecode.iterm2.plist LoadPrefsFromCustomFolder -bool true

if [ -d "~/.local/share/nvim/site/pack/packer/start/packer.nvim" ]
then  git clone --depth 1 https://github.com/wbthomason/packer.nvim ~/.local/share/nvim/site/pack/packer/start/packer.nvim
fi 

{{ end -}}
{{ end -}}
